<?php

/**
 * Plugin Name:   Vulnerability Alerts
 * Description:   Scans your system to find vulnerabilities listed in WPScan Vulnerability Database.
 * Plugin URI:    http://wordpress.org/plugins/vulnerability-alerts/
 * Version:       2.0
 * Author:        WPScan Team
 * Author URI:    https://wpscan.org
 * License:       GPLv3
 * License URI:   https://www.gnu.org/licenses/gpl.html
 * Text Domain:   vulnerability-alerts
 */

// File Security Check
defined( 'ABSPATH' ) or die( "No script kiddies please!" );

// remove old schedule
wp_clear_scheduled_hook( 'vulnerability-alerts_schedule' );

function deprecation_notice() {
  $class = 'notice notice-error';
  $plugin_name = 'wpscan';
  $install_link = '<a href="' . esc_url( network_admin_url('plugin-install.php?tab=plugin-information&plugin=' . $plugin_name . '&TB_iframe=true&width=600&height=550' ) ) . '" class="thickbox" title="More info about ' . $plugin_name . '">' . $plugin_name . '</a>';
	$message = 'The plugin "Vulnerability Alerts" is no longer maintained and was replaced by the plugin "WPScan". Click here to install ' . $install_link . '. Please also uninstall the "Vulnerability Alerts" plugin after you have upgraded.';

	printf( '<div class="%1$s"><p>%2$s</p></div>', esc_attr( $class ), $message ); 
}

add_action( 'admin_notices', 'deprecation_notice' );
